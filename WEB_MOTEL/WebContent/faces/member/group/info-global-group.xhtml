<ui:composition xmlns="http://www.w3.org/1999/xhtml"
                xmlns:h="http://java.sun.com/jsf/html"
                xmlns:ui="http://java.sun.com/jsf/facelets"
                xmlns:p="http://primefaces.org/ui"
                xmlns:f="http://xmlns.jcp.org/jsf/core">
    <p:tab title="#{msg['view.header.groupMember.global']}">
        <p:fieldset legend="#{msg['view.header.member.contact']}">
            <div class="Card">
                <div class="Container100 Responsive50">

                    <div class="Container25 Responsive50">
                        <span class="md-inputfield">
                            <p:inputText value="#{groupMemberController.curGroupMember.groupMemberCode}"
                                         id="memberGroupCode"
                                         title="#{msg['datatable.header.memberGroupCode']}"
                                         required="true"
                                         requiredMessage="#{msg['common.required'].replace('{0}',msg['datatable.header.memberCode'])}"
                            >
                            </p:inputText>

                            <label>#{msg['datatable.header.memberGroupCode']} *</label>
                        </span>
                        <p:message for="memberGroupCode"></p:message>
                    </div>
                    <div class="Container25 Responsive50">
                        <span class="md-inputfield">
                            <p:inputText value="#{groupMemberController.curGroupMember.groupMemberName}"
                                         id="memberGroupName"
                                         title="#{msg['datatable.header.memberGroupName']}"
                                         required="true"
                                         requiredMessage="#{msg['common.required'].replace('{0}',msg['datatable.header.memberName'])}"
                            >
                            </p:inputText>

                            <label>#{msg['datatable.header.memberGroupName']} *</label>
                        </span>
                        <p:message for="memberGroupName"></p:message>
                    </div>

                    <div class="Container25 Responsive50">
                        <span class="title-top">
                            <p:autoComplete value="#{groupMemberController.curGroupMember.deputationMember}"
                                            completeMethod="#{groupMemberController.searchMemberInherit}"
                                            style="" placeholder="#{msg['member.deputationMember']}" dropdown="true"
                                            id="deputationMemberId"
                                            var="mem"
                                            itemLabel="#{mem.memberCode} #{mem.memberCode!=null ?'-':''} #{mem.memberName}"
                                            itemValue="#{mem}" converter="memberConverter" forceSelection="true">
                                <p:column><h:outputText value="#{mem.memberCode}"/></p:column>
                                <p:column><h:outputText value="#{mem.memberName}"/></p:column>
                                <p:column><h:outputText value="#{mem.cardCode}"/></p:column>
                                <p:column><h:outputText value="#{mem.phoneNumber}"/></p:column>
                                <p:column><h:outputText value="#{mem.email}"/></p:column>
                                <p:column><h:outputText value="#{mem.address}"/></p:column>
                            </p:autoComplete>

                            <label class="title-elem">#{msg['member.deputationMember']} *</label>
                        </span>
                        <p:message for="deputationMemberId"></p:message>
                    </div>
                    <div class="Container25 Responsive50">
                        <span class="title-top">
                            <p:autoComplete id="employeeId" value="#{groupMemberController.curGroupMember.employee}"
                                            completeMethod="#{employeeController.completeEmployee}"
                                            placeholder="#{msg['catUser.employee']}" converter="employeeConverter"
                                            dropdown="true" scrollHeight="200"
                                            var="emp" itemLabel="#{emp.employeeCode} #{emp.employeeName}"
                                            itemValue="#{emp}">
                                <p:column><h:outputText value="#{emp.employeeCode}"/></p:column>
                                <p:column width="50"><h:outputText value="#{emp.employeeName}"/></p:column>
                                <p:column><h:outputText value="#{emp.jobTitle.jobTitleName}"/></p:column>
                                <p:column><h:outputText value="#{emp.telephone}"/></p:column>

                            </p:autoComplete>  
                            <label class="title-elem">#{msg['catUser.employee']}</label> 
                        </span>
                    </div>
                </div>

                <div class="Container100 Responsive50 MarTop20">

                    <div class="Container25 Responsive50">
                        <span class="title-top">
                            <p:calendar value="#{groupMemberController.curGroupMember.joinDate}"
                                        locale="#{language.localeCode}"
                                        styleClass="CalendarSearch"
                                        id="joinGroupDate"
                                        showButtonPanel="true" style="width: calc(100% - 15px)"
                                        title="#{msg['groupMember.header.joinDate']}"
                                        showOn="both"
                                        pattern="dd/MM/yyyy" pages="1" effect="slideDown"
                                        showOtherMonths="true" selectOtherMonths="true"
                                        mask="true">
                            </p:calendar>
                            <label class="title-elem">#{msg['groupMember.header.joinDate']}* </label>
                        </span>
                        <p:message for="joinGroupDate"></p:message>
                    </div>

                    <div class="Container25 Responsive50">
                        <span class="title-top">
                            <p:calendar value="#{groupMemberController.curGroupMember.endDate}"
                                        locale="#{language.localeCode}"
                                        mindate="#{currentDate}" styleClass="CalendarSearch"
                                        id="endGroupDate"
                                        showButtonPanel="true" style="width: calc(100% - 15px)"
                                        title="#{msg['datatable.header.endDate']}"
                                        showOn="both"
                                        pattern="dd/MM/yyyy" pages="1" effect="slideDown"
                                        showOtherMonths="true" selectOtherMonths="true"
                                        mask="true">
                            </p:calendar>

                            <label class="title-elem">#{msg['datatable.header.endDate']} *</label>
                        </span>
                        <p:message for="endGroupDate"></p:message>
                    </div>
                    <div class="Container25 Responsive50">
                        <span class="title-top">
                            <p:selectOneMenu id="statusGroup"
                                             value="#{groupMemberController.curGroupMember.status}"
                                             required="true"
                                             title="#{msg['datatable.header.status']}"
                                             style="width: 43%"
                            >
                                <f:selectItem itemLabel="#{msg['label.choose']}"
                                              noSelectionOption="true"/>
                                <f:selectItem itemLabel="#{msg['view.label.status0']}"
                                              itemValue="0"/>
                                <f:selectItem itemLabel="#{msg['view.label.status1']}"
                                              itemValue="1"/>
                                <f:selectItem itemLabel="#{msg['view.label.status2']}"
                                              itemValue="2"/>

                            </p:selectOneMenu>
                            <label class="title-elem">#{msg['datatable.header.status']} *</label>
                        </span>
                        <p:message for="statusGroup"></p:message>
                    </div>
                    <div class="Container25 Responsive50">

                        <span class="title-top">
                            <p:selectOneMenu id="branchGroupId"
                                             value="#{groupMemberController.curGroupMember.branchId}"
                                             required="true"
                                             title="#{msg['datatable.header.branchId']}"
                                             style=""
                            >
                                <f:selectItem itemLabel="#{msg['label.choose']}"
                                              noSelectionOption="true"/>
                                <f:selectItems value="#{branchController.branchs}" var="o"
                                               itemLabel="#{o.branchName}"
                                               itemValue="#{o.branchId}">

                                </f:selectItems>

                            </p:selectOneMenu>
                            <label class="title-elem">#{msg['datatable.header.branchId']} *</label>
                        </span>
                        <p:message for="branchGroupId"/>
                    </div>
                </div>
            </div>
        </p:fieldset>
        <p:fieldset legend="Danh sách thành viên" id="memberInGroupId" widgetVar="memberInGroupWid">
            <div class="Card">

                <div class="Container100 ">
                    <div class="Container25 Responsive50">
                        <div class="Container100">
                            <span class="title-top">
                                <p:autoComplete value="#{groupMemberController.memberAssign}"
                                                completeMethod="#{groupMemberController.searchMemberInherit}"
                                                style="" placeholder="#{msg['member.groupMember.member']}"
                                                scrollHeight="200" dropdown="true" id="memberAssignId"
                                                var="mem"
                                                itemLabel="#{mem.memberCode} #{mem.memberCode!=null ?'-':''} #{mem.memberName}"
                                                itemValue="#{mem}"
                                                converter="memberConverter" forceSelection="true">
                                    <p:column><h:outputText value="#{mem.memberCode}"/></p:column>
                                    <p:column><h:outputText value="#{mem.memberName}"/></p:column>
                                    <p:column><h:outputText value="#{mem.cardCode}"/></p:column>
                                    <p:column><h:outputText value="#{mem.phoneNumber}"/></p:column>
                                    <p:column><h:outputText value="#{mem.email}"/></p:column>
                                    <p:column><h:outputText value="#{mem.address}"/></p:column>
                                </p:autoComplete>

                                <label class="title-elem">#{msg['member.groupMember.member']}</label>
                            </span>
                            <p:message for="memberAssignId"></p:message>
                        </div>
                        <div class="Container100">
                            <p:commandButton value="Thêm thành viên" icon="fa fa-exchange"
                                             update="@widgetVar(tblGroupHasMember),@widgetVar(growl)"
                                             onclick="PF('block').show()"
                                             process="@widgetVar(memberInGroupWid)" oncomplete="PF('block').hide()"
                                             styleClass="AquaButton White Fs14"
                                             actionListener="#{groupMemberController.addGroupHasMember()}">

                            </p:commandButton>
                        </div>
                    </div>
                    <div class="Container75 Responsive50">
                        <p:dataTable value="#{groupMemberController.curGroupMember.lstGroupHasMembers}" var="objp"
                                     rowIndexVar="rp" widgetVar="tblGroupHasMember" id="tblGroupHasMemberId"
                                     rows="5" paginator="true" paginatorPosition="bottom" lazy="false"
                                     paginatorTemplate="{CurrentPageReport} {FirstPageLink} {PreviousPageLink} {PageLinks} {NextPageLink} {LastPageLink} {RowsPerPageDropdown}"
                                     currentPageReportTemplate="#{msg['label.total']} {totalRecords} #{msg['label.record']}"
                                     rowsPerPageTemplate="3,5,10,15,20,30,50"
                        >
                            <f:facet name="header">
                                <div class="Card NoPadding" style="background: transparent;">
                                    <div class="Container80 Responsive50">

                                        <h:outputText value="#{msg['member.groupHasMember']}"/>
                                    </div>
                                    <div class="Container20" style="text-align: right;">
                                        <p:commandButton id="toggler" type="button"
                                                         style="float:right" icon="fa fa-sliders"
                                                         styleClass="Fs14 White"/>
                                        <p:columnToggler datasource="tblGroupHasMemberId" trigger="toggler"/>
                                    </div>
                                </div>
                            </f:facet>
                            <p:column headerText="#{msg['datatable.header.stt']}" width="20">
                                <h:outputText value="#{rp + 1}"/>
                            </p:column>
                            <p:column headerText="#{msg['datatable.header.memberCode']}" width="100"
                                      sortBy="#{objp.member.memberCode}" filterStyle="width:70%"
                            >
                                <h:outputText value="#{objp.member.memberCode}"/>
                            </p:column>
                            <p:column headerText="#{msg['datatable.header.memberName']}" width="150"
                                      sortBy="#{objp.member.memberName}" filterStyle="width:70%"
                            >
                                <h:outputText value="#{objp.member.memberName}"/>
                            </p:column>
                            <p:column headerText="#{msg['datatable.header.cardCode']}" width="100"
                                      sortBy="#{objp.member.cardCode}" filterStyle="width:70%"
                            >
                                <h:outputText value="#{objp.member.cardCode}"/>
                            </p:column>
                            <p:column headerText="#{msg['datatable.header.phoneNumber']}" width="100"
                                      sortBy="#{objp.member.phoneNumber}" filterStyle="width:70%"
                            >
                                <h:outputText value="#{objp.member.phoneNumber}"/>
                            </p:column>
                            <p:column headerText="#{msg['datatable.header.email']}" width="100"
                                      sortBy="#{objp.member.email}" filterStyle="width:70%"
                            >
                                <h:outputText value="#{objp.member.email}"/>
                            </p:column>
                            <p:column headerText="Id" width="100" sortBy="#{objp.id}" visible="false"
                                      filterStyle="width:70%"
                            >
                                <h:outputText value="#{objp.id}"/>
                            </p:column>
                            <p:column headerText="#{msg['datatable.header.action']}" width="40">
                                <p:commandButton icon="fa fa-trash"
                                                 actionListener="#{groupMemberController.onDeleteGroupMemberInList(objp)}"
                                                 onclick="PF('block').show()" oncomplete="PF('block').hide();"
                                                 update="@widgetVar(tblGroupHasMember),@widgetVar(growlGroupMember)"
                                                 id="deleteGroupId"
                                                 title="#{msg['view.button.delete']}"
                                                 styleClass="White RedButton Fs14 MarTop5">
                                    <p:confirm icon="ui-icon-alert" header="#{msg['dialog.delete.header']}"
                                               message="#{msg['title.confirm.delete']}">
                                    </p:confirm>
                                </p:commandButton>
                            </p:column>

                        </p:dataTable>
                    </div>
                </div>
            </div>

        </p:fieldset>

        <div class="Card">
            <div class="Container100 Responsive50 TexAlRight">
                <p:commandButton value="#{msg['button.save']}" onclick="PF('block').show()"
                                 oncomplete="PF('block').hide()"
                                 actionListener="#{groupMemberController.saveOrUpdate}"
                                 update="tabViewMain:groupMemberForm,@widgetVar(growlGroupMember)"/>
            </div>
        </div>
    </p:tab>
</ui:composition>